var LiveView=(()=>{var h=Object.defineProperty;var m=Object.getOwnPropertyDescriptor;var b=Object.getOwnPropertyNames,g=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var w=(r,t,e)=>t in r?h(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,d=(r,t)=>{for(var e in t||(t={}))y.call(t,e)&&w(r,e,t[e]);if(g)for(var e of g(t))U.call(t,e)&&w(r,e,t[e]);return r};var v=(r,t)=>{for(var e in t)h(r,e,{get:t[e],enumerable:!0})},A=(r,t,e,c)=>{if(t&&typeof t=="object"||typeof t=="function")for(let s of b(t))!y.call(r,s)&&s!==e&&h(r,s,{get:()=>t[s],enumerable:!(c=m(t,s))||c.enumerable});return r};var $=r=>A(h({},"__esModule",{value:!0}),r);var x={};v(x,{enhanceLiveSocket:()=>R});function O(r){return encodeURIComponent(r).replace(/%5B/g,"[").replace(/%5D/g,"]")}function E(r,t){let e=r,c={};Object.entries(t).forEach(([i,o])=>{let n=new RegExp(`:${i}(?=/|$)`,"g");n.test(e)?e=e.replace(n,encodeURIComponent(String(o))):c[i]=o});let s=[];function a(i,o){i!=null&&(typeof i=="object"&&!Array.isArray(i)?Object.entries(i).forEach(([n,l])=>a(l,`${o}[${n}]`)):Array.isArray(i)?i.forEach((n,l)=>a(n,`${o}[${l}]`)):s.push(`${O(o)}=${encodeURIComponent(String(i))}`))}return Object.entries(c).forEach(([i,o])=>a(o,i)),s.length?`${e}?${s.join("&")}`:e}function S(){let r=document.getElementById("lv-page-params");if(!r)throw new Error('Element with id "lv-page-params" not found.');let t=r.getAttribute("lv-route");if(!t)throw new Error('Attribute "lv-route" not found.');let e={},c={};Array.from(r.attributes).forEach(({name:o,value:n})=>{if(o.startsWith("lv-url-")){let l=o.slice(7);e[l]=JSON.parse(n)}else if(o.startsWith("lv-data-")){let l=o.slice(8);c[l]=JSON.parse(n)}}),document.querySelectorAll("div[data-phx-component]").forEach(o=>{let n=o.id;if(!n)return;let l=`_${n}`;Array.from(o.attributes).forEach(({name:f,value:p})=>{if(f.startsWith("lv-url-")){let u=f.slice(7);e[l]=e[l]||{},e[l][u]=JSON.parse(p)}else if(f.startsWith("lv-data-")){let u=f.slice(8);c[l]=c[l]||{},c[l][u]=JSON.parse(p)}})});let s=E(t,e),a={};Object.keys(e).forEach(o=>a[o]=e[o]),Object.entries(c).forEach(([o,n])=>{a[o]&&typeof a[o]=="object"&&typeof n=="object"?a[o]=d(d({},a[o]),n):a[o]=n});let i=E(t,a);return{primaryUrl:s,combinedUrl:i}}function R(r){return r.domCallbacks.onPatchEnd=function(t){try{let e=S(),c=new URL(e.primaryUrl,window.location.origin),s=new URL(e.combinedUrl,window.location.origin);console.log("updating view href"),console.log("before "+window.liveSocket.href),console.log("after "+c.href),console.log("after 2"+s.href),r.historyPatch(c.href,"push"),window.liveSocket.href=c.href,window.liveSocket.main&&window.liveSocket.main.setHref(s.href)}catch(e){console.error("Error updating URL:",e)}},r.pushPatchUrl=(t,e={})=>{r.historyPatch(t,e)},window.addEventListener("phx:js-execute",({detail:t})=>{console.log("js-execute"),console.log(t.ops),r.execJS(document.body,t.ops)}),r}return $(x);})();
